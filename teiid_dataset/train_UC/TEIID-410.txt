Simplify command collector visitor
Command collector visitor modes are confusing and error prone.